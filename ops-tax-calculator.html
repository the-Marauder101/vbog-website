<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ops Tax Calculator â€” VBOG</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<style>
/* â”€â”€â”€ RESET & ROOT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --orange: #E8500A;
  --orange-light: #FF6B2B;
  --orange-dim: rgba(232,80,10,0.12);
  --black: #0F0F0F;
  --dark: #1A1A1A;
  --mid: #2E2E2E;
  --muted: #6B6B6B;
  --border: #2A2A2A;
  --border-light: #383838;
  --surface: #161616;
  --surface2: #1E1E1E;
  --white: #F8F5F0;
  --white-dim: rgba(248,245,240,0.6);
  --red: #E84040;
  --yellow: #E8B040;
  --green: #40C880;
  --font-display: 'Syne', sans-serif;
  --font-body: 'DM Sans', sans-serif;
  --radius: 4px;
  --radius-lg: 8px;
}

html { scroll-behavior: smooth; }

body {
  font-family: var(--font-body);
  background: var(--black);
  color: var(--white);
  min-height: 100vh;
  font-size: 15px;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€â”€ UTILITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hidden { display: none !important; }
.sr-only { position: absolute; width: 1px; height: 1px; overflow: hidden; clip: rect(0,0,0,0); }

/* â”€â”€â”€ TOP BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.topbar {
  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 32px; height: 56px;
  background: rgba(15,15,15,0.92);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
}
.topbar-logo {
  font-family: var(--font-display); font-weight: 800; font-size: 20px;
  color: var(--white); text-decoration: none; letter-spacing: -0.02em;
}
.topbar-logo span { color: var(--orange); }
.topbar-cta {
  font-family: var(--font-body); font-size: 13px; font-weight: 500;
  color: var(--orange); text-decoration: none; letter-spacing: 0.04em;
  border: 1px solid var(--orange); padding: 6px 16px; border-radius: var(--radius);
  transition: background 0.2s, color 0.2s;
}
.topbar-cta:hover { background: var(--orange); color: var(--white); }

/* â”€â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.progress-bar-wrap {
  position: fixed; top: 56px; left: 0; right: 0; z-index: 99;
  height: 3px; background: var(--border);
}
.progress-bar-fill {
  height: 100%; background: var(--orange);
  transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
  width: 0%;
}

/* â”€â”€â”€ MAIN LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main {
  max-width: 780px; margin: 0 auto;
  padding: 104px 24px 80px;
}

/* â”€â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero {
  padding: 60px 0 48px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 48px;
}
.hero-eyebrow {
  font-family: var(--font-body); font-size: 12px; font-weight: 500;
  letter-spacing: 0.14em; text-transform: uppercase;
  color: var(--orange); margin-bottom: 20px;
  display: flex; align-items: center; gap: 10px;
}
.hero-eyebrow::before {
  content: ''; display: block; width: 24px; height: 1px; background: var(--orange);
}
.hero h1 {
  font-family: var(--font-display); font-weight: 800; font-size: clamp(36px, 6vw, 60px);
  line-height: 1.0; letter-spacing: -0.03em; color: var(--white);
  margin-bottom: 20px;
}
.hero h1 em {
  font-style: normal; color: var(--orange);
  text-decoration: underline; text-decoration-color: var(--orange-dim);
  text-underline-offset: 6px;
}
.hero p {
  font-size: 17px; color: var(--white-dim); max-width: 520px;
  font-weight: 300; line-height: 1.65; margin-bottom: 28px;
}
.hero-stats {
  display: flex; gap: 32px; flex-wrap: wrap;
}
.hero-stat { display: flex; flex-direction: column; gap: 2px; }
.hero-stat strong {
  font-family: var(--font-display); font-size: 22px; font-weight: 700;
  color: var(--orange);
}
.hero-stat span { font-size: 12px; color: var(--muted); letter-spacing: 0.05em; }

/* â”€â”€â”€ SECTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.calc-section {
  display: none;
  animation: fadeUp 0.4s cubic-bezier(0.4,0,0.2,1);
}
.calc-section.active { display: block; }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}

.section-label {
  font-size: 11px; font-weight: 500; letter-spacing: 0.16em;
  text-transform: uppercase; color: var(--orange);
  margin-bottom: 8px;
}
.section-title {
  font-family: var(--font-display); font-weight: 700; font-size: 26px;
  letter-spacing: -0.02em; color: var(--white); margin-bottom: 6px;
}
.section-sub {
  font-size: 14px; color: var(--muted); margin-bottom: 36px;
}

/* â”€â”€â”€ FIELD GROUPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.field { margin-bottom: 28px; }
.field-label {
  display: flex; justify-content: space-between; align-items: baseline;
  margin-bottom: 10px;
}
.field-label span {
  font-size: 14px; font-weight: 500; color: var(--white);
}
.field-label .field-value {
  font-family: var(--font-display); font-weight: 700; font-size: 16px;
  color: var(--orange);
}

/* Sliders */
input[type="range"] {
  -webkit-appearance: none; appearance: none;
  width: 100%; height: 4px; background: var(--border-light);
  border-radius: 2px; outline: none; cursor: pointer;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none; appearance: none;
  width: 18px; height: 18px; border-radius: 50%;
  background: var(--orange); cursor: pointer;
  box-shadow: 0 0 0 3px rgba(232,80,10,0.2);
  transition: box-shadow 0.15s;
}
input[type="range"]::-webkit-slider-thumb:hover {
  box-shadow: 0 0 0 6px rgba(232,80,10,0.2);
}
input[type="range"]::-moz-range-thumb {
  width: 18px; height: 18px; border-radius: 50%;
  background: var(--orange); cursor: pointer; border: none;
}

/* Text + number inputs */
.text-input, .number-input {
  width: 100%; padding: 10px 14px;
  background: var(--surface2); border: 1px solid var(--border-light);
  border-radius: var(--radius); color: var(--white);
  font-family: var(--font-body); font-size: 15px;
  outline: none; transition: border-color 0.2s;
}
.text-input:focus, .number-input:focus { border-color: var(--orange); }

/* Selects */
select {
  width: 100%; padding: 10px 14px;
  background: var(--surface2); border: 1px solid var(--border-light);
  border-radius: var(--radius); color: var(--white);
  font-family: var(--font-body); font-size: 15px;
  outline: none; cursor: pointer; appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%236B6B6B' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right 14px center;
  padding-right: 36px; transition: border-color 0.2s;
}
select:focus { border-color: var(--orange); }
select option { background: var(--dark); }

/* Currency input row */
.currency-row {
  display: flex; align-items: center; gap: 0;
}
.currency-prefix {
  background: var(--border); border: 1px solid var(--border-light);
  border-right: none; border-radius: var(--radius) 0 0 var(--radius);
  padding: 10px 12px; color: var(--muted); font-size: 15px; white-space: nowrap;
}
.currency-row .number-input {
  border-radius: 0 var(--radius) var(--radius) 0;
}

/* â”€â”€â”€ SLIDER SUBLABEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.slider-hint { font-size: 12px; color: var(--muted); margin-top: 6px; }

/* â”€â”€â”€ PIE CHART BLOCK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.time-viz {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 24px; margin: 28px 0;
  display: flex; align-items: center; gap: 28px; flex-wrap: wrap;
}
.time-viz-chart { width: 110px; height: 110px; flex-shrink: 0; }
.time-viz-legend { flex: 1; display: flex; flex-direction: column; gap: 8px; }
.legend-item { display: flex; align-items: center; gap: 10px; font-size: 13px; }
.legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.legend-label { color: var(--muted); flex: 1; }
.legend-val { font-weight: 600; color: var(--white); font-family: var(--font-display); font-size: 14px; }

/* â”€â”€â”€ YES/NO QUESTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.yn-field { margin-bottom: 20px; }
.yn-question {
  font-size: 14px; color: var(--white); margin-bottom: 10px; line-height: 1.5;
}
.yn-options { display: flex; gap: 8px; flex-wrap: wrap; }
.yn-btn {
  padding: 8px 20px; border-radius: var(--radius);
  border: 1px solid var(--border-light);
  background: transparent; color: var(--muted);
  font-family: var(--font-body); font-size: 13px; font-weight: 500;
  cursor: pointer; transition: all 0.15s; letter-spacing: 0.02em;
}
.yn-btn:hover { border-color: var(--orange-dim); color: var(--white); }
.yn-btn.selected {
  background: var(--orange-dim); border-color: var(--orange);
  color: var(--orange); font-weight: 600;
}

/* â”€â”€â”€ DIVIDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.divider { border: none; border-top: 1px solid var(--border); margin: 36px 0; }

/* â”€â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn-primary {
  display: inline-flex; align-items: center; gap: 10px;
  background: var(--orange); color: var(--white);
  font-family: var(--font-display); font-weight: 700; font-size: 16px;
  padding: 14px 32px; border-radius: var(--radius);
  border: none; cursor: pointer; letter-spacing: -0.01em;
  transition: background 0.2s, transform 0.15s;
  text-decoration: none;
}
.btn-primary:hover { background: var(--orange-light); transform: translateY(-1px); }
.btn-primary .arrow { font-size: 20px; transition: transform 0.2s; }
.btn-primary:hover .arrow { transform: translateX(4px); }

.btn-secondary {
  display: inline-flex; align-items: center; gap: 8px;
  background: transparent; color: var(--muted);
  font-family: var(--font-body); font-size: 14px; font-weight: 400;
  padding: 10px 0; border: none; cursor: pointer;
  transition: color 0.2s; text-decoration: none;
}
.btn-secondary:hover { color: var(--white); }

.btn-ghost {
  display: inline-flex; align-items: center; gap: 8px;
  background: transparent; color: var(--orange);
  font-family: var(--font-body); font-size: 14px; font-weight: 500;
  padding: 10px 20px; border: 1px solid var(--orange);
  border-radius: var(--radius); cursor: pointer;
  transition: background 0.2s, color 0.2s; text-decoration: none;
}
.btn-ghost:hover { background: var(--orange-dim); }

.btn-row { display: flex; align-items: center; gap: 20px; margin-top: 36px; flex-wrap: wrap; }

/* â”€â”€â”€ RESULTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#section-results { padding-bottom: 40px; }

.result-hero {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 36px; margin-bottom: 24px;
  position: relative; overflow: hidden;
}
.result-hero::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
  background: var(--orange);
}
.result-tax-label {
  font-size: 12px; font-weight: 500; letter-spacing: 0.14em;
  text-transform: uppercase; color: var(--muted); margin-bottom: 8px;
}
.result-tax-amount {
  font-family: var(--font-display); font-weight: 800;
  font-size: clamp(40px, 8vw, 68px); letter-spacing: -0.03em;
  color: var(--orange); line-height: 1; margin-bottom: 4px;
}
.result-tax-period { font-size: 14px; color: var(--muted); margin-bottom: 24px; }

.result-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 0;
}
@media (max-width: 520px) { .result-grid { grid-template-columns: 1fr; } }

.result-card {
  background: var(--dark); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px;
}
.result-card-label {
  font-size: 11px; letter-spacing: 0.12em; text-transform: uppercase;
  color: var(--muted); margin-bottom: 6px;
}
.result-card-value {
  font-family: var(--font-display); font-weight: 700; font-size: 22px;
  letter-spacing: -0.02em; color: var(--white);
}
.result-card-value.positive { color: var(--green); }
.result-card-note { font-size: 12px; color: var(--muted); margin-top: 4px; }

/* BOSS Score */
.boss-score-block {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 28px; margin-bottom: 24px;
}
.boss-score-row { display: flex; align-items: center; gap: 24px; flex-wrap: wrap; }
.boss-score-number {
  font-family: var(--font-display); font-weight: 800; font-size: 56px;
  letter-spacing: -0.04em; line-height: 1;
}
.boss-score-info { flex: 1; }
.boss-score-badge {
  display: inline-block; font-size: 12px; font-weight: 600;
  letter-spacing: 0.08em; text-transform: uppercase;
  padding: 4px 12px; border-radius: 100px; margin-bottom: 8px;
}
.boss-score-desc { font-size: 14px; color: var(--muted); line-height: 1.5; }

.boss-bar-wrap { margin-top: 20px; }
.boss-bar-track {
  height: 8px; background: var(--border); border-radius: 4px; overflow: hidden;
}
.boss-bar-fill { height: 100%; border-radius: 4px; transition: width 1s cubic-bezier(0.4,0,0.2,1) 0.3s; }
.boss-bar-ticks {
  display: flex; justify-content: space-between;
  margin-top: 6px; font-size: 11px; color: var(--muted);
}

/* Breakdown */
.breakdown-block {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 28px; margin-bottom: 24px;
}
.breakdown-title {
  font-family: var(--font-display); font-weight: 700; font-size: 16px;
  letter-spacing: -0.01em; margin-bottom: 20px; color: var(--white);
}
.breakdown-item {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 0; border-bottom: 1px solid var(--border);
}
.breakdown-item:last-child { border-bottom: none; padding-bottom: 0; }
.breakdown-bar-wrap { flex: 1; }
.breakdown-name { font-size: 13px; color: var(--white); margin-bottom: 5px; }
.breakdown-sub { font-size: 12px; color: var(--muted); }
.breakdown-bar { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; margin-top: 6px; }
.breakdown-bar-inner { height: 100%; border-radius: 2px; transition: width 0.8s cubic-bezier(0.4,0,0.2,1) 0.4s; }
.breakdown-amount {
  font-family: var(--font-display); font-weight: 700; font-size: 16px;
  color: var(--white); white-space: nowrap; flex-shrink: 0;
}

/* Narrative */
.narrative-block {
  border-left: 3px solid var(--orange); padding-left: 20px; margin-bottom: 28px;
}
.narrative-text { font-size: 15px; color: var(--white-dim); line-height: 1.7; font-weight: 300; font-style: italic; }

/* Top leakage factors */
.leakage-block {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 28px; margin-bottom: 24px;
}
.leakage-title {
  font-family: var(--font-display); font-weight: 700; font-size: 16px;
  margin-bottom: 16px; color: var(--white);
}
.leakage-item {
  display: flex; align-items: flex-start; gap: 12px;
  padding: 10px 0; border-bottom: 1px solid var(--border);
}
.leakage-item:last-child { border-bottom: none; }
.leakage-icon {
  width: 28px; height: 28px; border-radius: 50%; background: rgba(232,80,10,0.15);
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; flex-shrink: 0; margin-top: 1px;
}
.leakage-text { flex: 1; }
.leakage-name { font-size: 13px; color: var(--white); font-weight: 500; }
.leakage-impact { font-size: 12px; color: var(--muted); margin-top: 2px; }
.leakage-pct { font-family: var(--font-display); font-weight: 700; font-size: 15px; color: var(--red); flex-shrink: 0; }

/* CTA block */
.cta-block {
  background: linear-gradient(135deg, rgba(232,80,10,0.1) 0%, rgba(15,15,15,0) 60%);
  border: 1px solid var(--orange);
  border-radius: var(--radius-lg); padding: 36px; margin-bottom: 24px;
  text-align: center;
}
.cta-headline {
  font-family: var(--font-display); font-weight: 800; font-size: 24px;
  letter-spacing: -0.02em; margin-bottom: 10px; color: var(--white);
}
.cta-sub { font-size: 15px; color: var(--muted); margin-bottom: 28px; font-weight: 300; }
.cta-actions { display: flex; justify-content: center; gap: 16px; flex-wrap: wrap; }

/* Email capture */
.email-row {
  display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap;
}
.email-row .text-input { flex: 1; min-width: 200px; }
.email-row .btn-ghost { white-space: nowrap; }

/* Share button */
.share-text {
  font-size: 13px; color: var(--muted); text-align: center; margin-top: 16px;
}

/* â”€â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 600px) {
  .topbar { padding: 0 16px; }
  .main { padding: 96px 16px 60px; }
  .hero { padding: 40px 0 36px; }
  .hero-stats { gap: 20px; }
  .result-hero { padding: 24px; }
}

/* â”€â”€â”€ PHASE TAG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.phase-tag {
  display: inline-flex; align-items: center; gap: 6px;
  font-size: 11px; font-weight: 500; letter-spacing: 0.1em;
  text-transform: uppercase; color: var(--muted);
  border: 1px solid var(--border-light);
  padding: 3px 10px; border-radius: 100px; margin-bottom: 28px;
}
.phase-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--orange); }

/* â”€â”€â”€ STEP INDICATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.step-indicator {
  display: flex; align-items: center; gap: 8px; margin-bottom: 32px;
  font-size: 12px; color: var(--muted);
}
.step-pip {
  width: 24px; height: 24px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 11px; font-weight: 700; border: 1px solid var(--border-light);
  background: transparent; color: var(--muted); transition: all 0.3s;
}
.step-pip.done { background: var(--orange); border-color: var(--orange); color: white; }
.step-pip.active { border-color: var(--orange); color: var(--orange); }
.step-line { flex: 1; height: 1px; background: var(--border); max-width: 48px; }

/* â”€â”€â”€ TOOLTIP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.tooltip-wrap { position: relative; display: inline-block; }
.tooltip-icon {
  width: 16px; height: 16px; border-radius: 50%;
  border: 1px solid var(--border-light); background: transparent;
  color: var(--muted); font-size: 10px; font-weight: 700;
  display: inline-flex; align-items: center; justify-content: center;
  cursor: help; margin-left: 6px; vertical-align: middle;
}
.tooltip-box {
  display: none; position: absolute; bottom: calc(100% + 8px); left: 50%;
  transform: translateX(-50%); background: var(--mid); border: 1px solid var(--border-light);
  border-radius: var(--radius); padding: 10px 14px; width: 220px;
  font-size: 12px; color: var(--white-dim); line-height: 1.5; z-index: 200;
}
.tooltip-wrap:hover .tooltip-box { display: block; }
</style>
</head>
<body>

<!-- TOP BAR -->
<nav class="topbar">
  <a href="https://v-bog.com" class="topbar-logo">V<span>BOG</span></a>
  <a href="https://calendly.com/depesh-v-bog/30min" target="_blank" class="topbar-cta">Book a Call</a>
</nav>
<div class="progress-bar-wrap"><div class="progress-bar-fill" id="progressFill"></div></div>

<!-- MAIN -->
<main class="main">

  <!-- HERO -->
  <section class="hero" id="heroSection">
    <div class="hero-eyebrow">VBOG Â· Ops Tax Calculator</div>
    <h1>What's your<br><em>Ops Tax?</em></h1>
    <p>Find out how much it's costing you to run your business instead of growing it. Takes 3 minutes. No fluff, just math.</p>
    <div class="hero-stats">
      <div class="hero-stat">
        <strong>15+ hrs</strong>
        <span>Freed per week on avg</span>
      </div>
      <div class="hero-stat">
        <strong>2â€“3Ã—</strong>
        <span>Revenue growth in 12mo</span>
      </div>
      <div class="hero-stat">
        <strong>$120K MRR</strong>
        <span>From $15K in 10 months</span>
      </div>
    </div>
    <div class="btn-row" style="margin-top:36px;">
      <button class="btn-primary" onclick="startCalc()">
        Start the Calculator <span class="arrow">â†’</span>
      </button>
    </div>
  </section>

  <!-- â”€â”€â”€ SECTION A: BUSINESS BASICS â”€â”€â”€ -->
  <section class="calc-section" id="section-a">
    <div class="step-indicator">
      <div class="step-pip active" id="pip1">1</div>
      <div class="step-line"></div>
      <div class="step-pip" id="pip2">2</div>
      <div class="step-line"></div>
      <div class="step-pip" id="pip3">3</div>
      <div class="step-line"></div>
      <div class="step-pip" id="pip4">âœ“</div>
    </div>

    <div class="section-label">Step 1 of 3</div>
    <div class="section-title">Your Business Basics</div>
    <div class="section-sub">Give me the numbers I need to calculate your real cost.</div>

    <!-- MRR -->
    <div class="field">
      <div class="field-label">
        <span>Monthly Recurring Revenue (MRR) <span class="tooltip-wrap"><span class="tooltip-icon">?</span><span class="tooltip-box">Your average monthly revenue. If it varies, use a 3-month average.</span></span></span>
        <span class="field-value" id="val-mrr">$25,000</span>
      </div>
      <input type="range" id="sl-mrr" min="5000" max="200000" step="1000" value="25000"
        oninput="updateSlider('mrr', this.value)">
      <div class="slider-hint">$5K â€” $200K</div>
    </div>

    <!-- Business Type -->
    <div class="field">
      <div class="field-label"><span>Business Type</span></div>
      <select id="sel-biztype" onchange="updateBizType()">
        <option value="agency">Agency</option>
        <option value="consulting">Consulting / Advisory</option>
        <option value="staffaug">Staff Augmentation</option>
        <option value="managed">Managed Services</option>
        <option value="coaching">Coaching / Training</option>
      </select>
    </div>

    <!-- Team Size -->
    <div class="field">
      <div class="field-label">
        <span>Team Size (excluding you)</span>
        <span class="field-value" id="val-team">4</span>
      </div>
      <input type="range" id="sl-team" min="1" max="30" step="1" value="4"
        oninput="updateSlider('team', this.value)">
      <div class="slider-hint">1 â€” 30 people</div>
    </div>

    <!-- ACV -->
    <div class="field">
      <div class="field-label">
        <span>Avg Monthly Contract Value (per client) <span class="tooltip-wrap"><span class="tooltip-icon">?</span><span class="tooltip-box">What a typical client pays you per month. Used to calculate how many deals you're missing.</span></span></span>
        <span class="field-value" id="val-acv">$3,000</span>
      </div>
      <input type="range" id="sl-acv" min="500" max="30000" step="250" value="3000"
        oninput="updateSlider('acv', this.value)">
      <div class="slider-hint">$500 â€” $30K</div>
    </div>

    <!-- Growth Rate -->
    <div class="field">
      <div class="field-label"><span>Annual Revenue Growth Rate</span></div>
      <select id="sel-growth">
        <option value="low">Under 10%</option>
        <option value="mid" selected>10â€“20%</option>
        <option value="high">20â€“40%</option>
        <option value="vhigh">Above 40%</option>
      </select>
    </div>

    <div class="btn-row">
      <button class="btn-primary" onclick="goSection('b')">
        Next: My Time <span class="arrow">â†’</span>
      </button>
    </div>
  </section>

  <!-- â”€â”€â”€ SECTION B: TIME ALLOCATION â”€â”€â”€ -->
  <section class="calc-section" id="section-b">
    <div class="step-indicator">
      <div class="step-pip done" id="pip1b">âœ“</div>
      <div class="step-line"></div>
      <div class="step-pip active" id="pip2b">2</div>
      <div class="step-line"></div>
      <div class="step-pip" id="pip3b">3</div>
      <div class="step-line"></div>
      <div class="step-pip" id="pip4b">âœ“</div>
    </div>

    <div class="section-label">Step 2 of 3</div>
    <div class="section-title">How Are You Spending Your Time?</div>
    <div class="section-sub">Move the sliders to match your typical day. Watch your ops load in real time.</div>

    <!-- Total Hours -->
    <div class="field">
      <div class="field-label">
        <span>Total hours you work per day</span>
        <span class="field-value" id="val-total-hrs">9 hrs</span>
      </div>
      <input type="range" id="sl-total-hrs" min="6" max="14" step="0.5" value="9"
        oninput="updateTimeSlider()">
      <div class="slider-hint">6 â€” 14 hrs/day</div>
    </div>

    <!-- Sales Hours -->
    <div class="field">
      <div class="field-label">
        <span>Hours on sales & growth per day <span class="tooltip-wrap"><span class="tooltip-icon">?</span><span class="tooltip-box">Actual selling, business development, strategy. Not meetings about delivery.</span></span></span>
        <span class="field-value" id="val-sales-hrs">1.5 hrs</span>
      </div>
      <input type="range" id="sl-sales-hrs" min="0" max="8" step="0.5" value="1.5"
        oninput="updateTimeSlider()">
    </div>

    <!-- Review Hours -->
    <div class="field">
      <div class="field-label">
        <span>Hours reviewing team work per day</span>
        <span class="field-value" id="val-review-hrs">2 hrs</span>
      </div>
      <input type="range" id="sl-review-hrs" min="0" max="6" step="0.5" value="2"
        oninput="updateTimeSlider()">
    </div>

    <!-- Meeting Hours -->
    <div class="field">
      <div class="field-label">
        <span>Hours in standups & meetings per day</span>
        <span class="field-value" id="val-meeting-hrs">1.5 hrs</span>
      </div>
      <input type="range" id="sl-meeting-hrs" min="0" max="5" step="0.5" value="1.5"
        oninput="updateTimeSlider()">
    </div>

    <!-- Firefighting Hours -->
    <div class="field">
      <div class="field-label">
        <span>Hours firefighting / reacting per day <span class="tooltip-wrap"><span class="tooltip-icon">?</span><span class="tooltip-box">Ad-hoc questions from the team, unplanned client escalations, putting out fires.</span></span></span>
        <span class="field-value" id="val-fire-hrs">2 hrs</span>
      </div>
      <input type="range" id="sl-fire-hrs" min="0" max="6" step="0.5" value="2"
        oninput="updateTimeSlider()">
    </div>

    <!-- Pie Chart Visualization -->
    <div class="time-viz" id="timeViz">
      <div class="time-viz-chart">
        <canvas id="pieChart"></canvas>
      </div>
      <div class="time-viz-legend" id="pieLegend">
        <!-- Filled by JS -->
      </div>
    </div>

    <div style="background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:14px 18px; margin-bottom:8px;">
      <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">Your Founder Hourly Rate</div>
      <div style="font-family:var(--font-display); font-weight:700; font-size:20px; color:var(--orange);" id="hourlyRateDisplay">â€”</div>
      <div style="font-size:12px; color:var(--muted); margin-top:3px;">Based on MRR Ã— 12 Ã· annual working hours</div>
    </div>

    <div class="btn-row">
      <button class="btn-primary" onclick="goSection('c')">
        Next: Health Check <span class="arrow">â†’</span>
      </button>
      <button class="btn-secondary" onclick="goSection('a')">â† Back</button>
    </div>
  </section>

  <!-- â”€â”€â”€ SECTION C: HEALTH CHECK â”€â”€â”€ -->
  <section class="calc-section" id="section-c">
    <div class="step-indicator">
      <div class="step-pip done">âœ“</div>
      <div class="step-line"></div>
      <div class="step-pip done">âœ“</div>
      <div class="step-line"></div>
      <div class="step-pip active">3</div>
      <div class="step-line"></div>
      <div class="step-pip" id="pip4c">âœ“</div>
    </div>

    <div class="section-label">Step 3 of 3</div>
    <div class="section-title">Quick Health Check</div>
    <div class="section-sub">Nine questions. Answer honestly â€” the math only works if you do.</div>

    <div id="healthQuestions">
      <!-- Rendered by JS -->
    </div>

    <div class="btn-row" style="margin-top:36px;">
      <button class="btn-primary" onclick="calculateAndShow()">
        Calculate My Ops Tax <span class="arrow">â†’</span>
      </button>
      <button class="btn-secondary" onclick="goSection('b')">â† Back</button>
    </div>
  </section>

  <!-- â”€â”€â”€ RESULTS â”€â”€â”€ -->
  <section class="calc-section" id="section-results">

    <!-- Primary Number -->
    <div class="result-hero">
      <div class="result-tax-label">Your Monthly Ops Tax</div>
      <div class="result-tax-amount" id="r-monthly-tax">â€”</div>
      <div class="result-tax-period">every month you stay in the weeds</div>
      <div class="result-grid">
        <div class="result-card">
          <div class="result-card-label">12-Month Opportunity Cost</div>
          <div class="result-card-value" id="r-annual-cost">â€”</div>
          <div class="result-card-note">if nothing changes this year</div>
        </div>
        <div class="result-card">
          <div class="result-card-label">Growth Unlock (MRR)</div>
          <div class="result-card-value positive" id="r-growth-unlock">â€”</div>
          <div class="result-card-note">new MRR you could add with 15 hrs back</div>
        </div>
      </div>
    </div>

    <!-- BOSS Score -->
    <div class="boss-score-block">
      <div class="boss-score-row">
        <div class="boss-score-number" id="r-boss-number" style="color:var(--red)">â€”</div>
        <div class="boss-score-info">
          <div class="boss-score-badge" id="r-boss-badge">â€”</div>
          <div class="boss-score-desc" id="r-boss-desc">â€”</div>
        </div>
      </div>
      <div class="boss-bar-wrap">
        <div class="boss-bar-track">
          <div class="boss-bar-fill" id="r-boss-bar" style="width:0%"></div>
        </div>
        <div class="boss-bar-ticks">
          <span>Critical</span><span>Unstable</span><span>Developing</span><span>Functional</span><span>Scale-Ready</span>
        </div>
      </div>
    </div>

    <!-- Narrative -->
    <div class="narrative-block">
      <p class="narrative-text" id="r-narrative">â€”</p>
    </div>

    <!-- Breakdown -->
    <div class="breakdown-block">
      <div class="breakdown-title">What's Making Up Your Ops Tax</div>
      <div id="r-breakdown"><!-- filled by JS --></div>
    </div>

    <!-- Top Leakage Factors -->
    <div class="leakage-block" id="r-leakage-block">
      <div class="leakage-title">Top Revenue Leakage Factors</div>
      <div id="r-leakage-items"><!-- filled by JS --></div>
    </div>

    <!-- CTA -->
    <div class="cta-block">
      <div class="cta-headline">Ready to stop paying this tax?</div>
      <div class="cta-sub">Let's talk about getting 15+ hours back per week â€” and what you'll do with them. Free 30-minute call.</div>
      <div class="cta-actions">
        <a href="https://calendly.com/depesh-v-bog/30min" target="_blank" class="btn-primary">
          Book a Free Discovery Call <span class="arrow">â†’</span>
        </a>
        <button class="btn-ghost" onclick="downloadPDF()">â†“ Download Results</button>
      </div>
      <div class="email-row">
        <input type="email" id="emailInput" class="text-input" placeholder="Email me my results (optional)">
        <button class="btn-ghost" onclick="emailResults()">Send</button>
      </div>
    </div>

    <div class="share-text" id="shareText">
      <button class="btn-secondary" onclick="shareResult()">Share my Ops Tax score â†’</button>
    </div>

    <div class="btn-row" style="justify-content:center; margin-top:16px;">
      <button class="btn-secondary" onclick="restartCalc()">â† Start Over</button>
    </div>

  </section>

</main>

<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CONFIG â€” All weights live here. Edit freely.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const CONFIG = {
  workingDaysPerMonth: 22,
  workingWeeksPerYear: 48,
  workingDaysPerYear: 240,  // 48wks Ã— 5
  meetingProductivityFactor: 0.40,   // 40% of meeting time is actually productive
  firefightingOverhead: 1.25,        // context-switching premium
  freedHoursSalesAllocation: 0.70,   // 70% of freed time goes to sales
  closeRateAssumption: 0.30,

  salesHoursPerDeal: {
    agency: 6, consulting: 8, staffaug: 5, managed: 7, coaching: 7
  },

  leakageWeights: {
    noRenewalProcess:          0.08,
    founderApprovesPricing:    0.04,
    noKPIReview:               0.05,
    noContractSystem:          0.04,
    oftenOverScope:            0.06,
    sometimesOverScope:        0.03,
    teamClarityUnclear:        0.05,
    teamClaritySomewhat:       0.02,
    highInterruptions:         0.03,
    founderHandlesEscalations: 0.03,
    teamNoDirectDelivery:      0.02,
  },
  maxLeakagePct: 0.35,

  chaosMultiplier: { 3: 0.06, 2: 0.04, 1: 0.02, 0: 0 },

  growthMultiplier: { low: 1.0, mid: 1.15, high: 1.3, vhigh: 1.5 },

  bossWeights: {
    founderDependency:   25,
    delegation:          20,
    cadence:             20,
    revenuePredictability: 20,
    systems:             15,
  },

  scoreColors: {
    critical:    '#E84040',
    unstable:    '#E88040',
    developing:  '#E8C840',
    functional:  '#80C840',
    scaleReady:  '#40C880',
  }
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   STATE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let state = {
  mrr: 25000, biztype: 'agency', team: 4, acv: 3000, growth: 'mid',
  totalHrs: 9, salesHrs: 1.5, reviewHrs: 2, meetingHrs: 1.5, fireHrs: 2,
  health: {}  // key: answer
};

let pieChart = null;

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   HEALTH QUESTIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const QUESTIONS = [
  {
    id: 'renewalProcess',
    q: 'Do you have a documented renewal or extension process for contracts?',
    options: ['Yes', 'No'],
    leakageKey: { No: 'noRenewalProcess' }
  },
  {
    id: 'pricingApproval',
    q: 'Do you personally review and approve pricing for new deals?',
    options: ['Yes', 'No'],
    leakageKey: { Yes: 'founderApprovesPricing' }
  },
  {
    id: 'kpiReview',
    q: 'Does your team have a weekly KPI review with defined owners?',
    options: ['Yes', 'No'],
    leakageKey: { No: 'noKPIReview' }
  },
  {
    id: 'interruptions',
    q: 'Does your team message you 10+ times per day with questions?',
    options: ['Yes', 'No'],
    leakageKey: { Yes: 'highInterruptions' }
  },
  {
    id: 'escalations',
    q: 'Do you personally handle all client escalations?',
    options: ['Yes', 'No'],
    leakageKey: { Yes: 'founderHandlesEscalations' }
  },
  {
    id: 'contractSystem',
    q: 'Are all client contracts and renewals tracked in a single system?',
    options: ['Yes', 'No'],
    leakageKey: { No: 'noContractSystem' }
  },
  {
    id: 'directDelivery',
    q: 'Does your team send completed work directly to clients without your review?',
    options: ['Yes', 'No'],
    leakageKey: { No: 'teamNoDirectDelivery' }
  },
  {
    id: 'scopeCreep',
    q: 'How often do projects run over scope or budget?',
    options: ['Never', 'Sometimes', 'Often'],
    leakageKey: { Sometimes: 'sometimesOverScope', Often: 'oftenOverScope' }
  },
  {
    id: 'teamClarity',
    q: 'How clear is your team on what to prioritize without asking you?',
    options: ['Very Clear', 'Somewhat Clear', 'Unclear'],
    leakageKey: { 'Somewhat Clear': 'teamClaritySomewhat', 'Unclear': 'teamClarityUnclear' }
  },
];

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   RENDER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderHealthQuestions() {
  const container = document.getElementById('healthQuestions');
  container.innerHTML = '';
  QUESTIONS.forEach(q => {
    const div = document.createElement('div');
    div.className = 'yn-field';
    div.innerHTML = `
      <div class="yn-question">${q.q}</div>
      <div class="yn-options" id="opts-${q.id}">
        ${q.options.map(o => `
          <button class="yn-btn ${state.health[q.id] === o ? 'selected' : ''}"
            onclick="selectAnswer('${q.id}', '${o}', this)">
            ${o}
          </button>
        `).join('')}
      </div>
    `;
    container.appendChild(div);
    if (q !== QUESTIONS[QUESTIONS.length - 1]) {
      const hr = document.createElement('hr');
      hr.className = 'divider';
      hr.style.margin = '16px 0';
      container.appendChild(hr);
    }
  });
}

function selectAnswer(qid, answer, btn) {
  state.health[qid] = answer;
  const opts = document.getElementById(`opts-${qid}`);
  opts.querySelectorAll('.yn-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SLIDER & INPUT UPDATES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function fmt(n) { return '$' + n.toLocaleString(); }
function fmtHr(n) { return n % 1 === 0 ? n + ' hrs' : n + ' hrs'; }

function updateSlider(key, val) {
  val = parseFloat(val);
  state[key] = val;
  if (key === 'mrr') document.getElementById('val-mrr').textContent = fmt(val);
  if (key === 'team') document.getElementById('val-team').textContent = val;
  if (key === 'acv') document.getElementById('val-acv').textContent = fmt(val);
  updateHourlyRate();
}

function updateBizType() {
  state.biztype = document.getElementById('sel-biztype').value;
}

function updateTimeSlider() {
  state.totalHrs   = parseFloat(document.getElementById('sl-total-hrs').value);
  state.salesHrs   = parseFloat(document.getElementById('sl-sales-hrs').value);
  state.reviewHrs  = parseFloat(document.getElementById('sl-review-hrs').value);
  state.meetingHrs = parseFloat(document.getElementById('sl-meeting-hrs').value);
  state.fireHrs    = parseFloat(document.getElementById('sl-fire-hrs').value);

  document.getElementById('val-total-hrs').textContent   = fmtHr(state.totalHrs);
  document.getElementById('val-sales-hrs').textContent   = fmtHr(state.salesHrs);
  document.getElementById('val-review-hrs').textContent  = fmtHr(state.reviewHrs);
  document.getElementById('val-meeting-hrs').textContent = fmtHr(state.meetingHrs);
  document.getElementById('val-fire-hrs').textContent    = fmtHr(state.fireHrs);

  updatePieChart();
  updateHourlyRate();
}

function updateHourlyRate() {
  const annualRevenue = state.mrr * 12;
  const annualHrs = state.totalHrs * CONFIG.workingDaysPerYear;
  const rate = Math.round(annualRevenue / annualHrs);
  const el = document.getElementById('hourlyRateDisplay');
  if (el) el.textContent = '$' + rate.toLocaleString() + '/hr';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PIE CHART
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function initPieChart() {
  const ctx = document.getElementById('pieChart').getContext('2d');
  pieChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Sales & Growth', 'Reviewing Work', 'Meetings', 'Firefighting', 'Other Ops'],
      datasets: [{
        data: [1.5, 2, 1.5, 2, 2],
        backgroundColor: ['#40C880','#E8500A','#E88040','#E84040','#383838'],
        borderWidth: 0, hoverOffset: 4,
      }]
    },
    options: {
      cutout: '68%', responsive: true, maintainAspectRatio: true,
      plugins: { legend: { display: false }, tooltip: { enabled: false } },
      animation: { duration: 400 }
    }
  });
  updatePieChart();
}

function updatePieChart() {
  if (!pieChart) return;
  const s = state;
  const other = Math.max(0, s.totalHrs - s.salesHrs - s.reviewHrs - s.meetingHrs - s.fireHrs);
  const data = [s.salesHrs, s.reviewHrs, s.meetingHrs, s.fireHrs, other];
  pieChart.data.datasets[0].data = data;
  pieChart.update();

  const labels = ['Sales & Growth','Reviewing Work','Meetings','Firefighting','Other Ops'];
  const colors = ['#40C880','#E8500A','#E88040','#E84040','#383838'];
  const legend = document.getElementById('pieLeged') || document.getElementById('pieChart').closest('.time-viz').querySelector('.time-viz-legend');
  if (legend) {
    legend.innerHTML = labels.map((l,i) => `
      <div class="legend-item">
        <div class="legend-dot" style="background:${colors[i]}"></div>
        <div class="legend-label">${l}</div>
        <div class="legend-val">${data[i].toFixed(1)} hrs</div>
      </div>
    `).join('');
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   CALCULATION ENGINE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function calculate() {
  const S = state;
  const C = CONFIG;

  // Founder hourly rate
  const annualRevenue = S.mrr * 12;
  const annualHrs = S.totalHrs * C.workingDaysPerYear;
  const hourlyRate = annualRevenue / annualHrs;

  // Ops hours per day
  const opsHrsPerDay = S.totalHrs - S.salesHrs;

  // COMPONENT 1: Time Cost
  const reviewCost   = S.reviewHrs * C.workingDaysPerMonth * hourlyRate;
  const meetingWaste = S.meetingHrs * (1 - C.meetingProductivityFactor) * C.workingDaysPerMonth * hourlyRate;
  const fireCost     = S.fireHrs * C.firefightingOverhead * C.workingDaysPerMonth * hourlyRate;
  const timeCost     = reviewCost + meetingWaste + fireCost;

  // COMPONENT 2: Revenue Leakage
  let leakagePct = 0;
  const leakageFactors = [];
  const H = S.health;

  function addLeakage(conditionKey, label, pct, icon) {
    leakagePct += pct;
    leakageFactors.push({ label, pct, icon, amount: S.mrr * pct });
  }

  // Map health answers to leakage
  if (H.renewalProcess === 'No')
    addLeakage('renewalProcess', 'No documented renewal process', C.leakageWeights.noRenewalProcess, 'ğŸ”„');
  if (H.pricingApproval === 'Yes')
    addLeakage('pricingApproval', 'Founder approves all pricing', C.leakageWeights.founderApprovesPricing, 'ğŸ’¸');
  if (H.kpiReview === 'No')
    addLeakage('kpiReview', 'No weekly KPI review', C.leakageWeights.noKPIReview, 'ğŸ“Š');
  if (H.contractSystem === 'No')
    addLeakage('contractSystem', 'No central contract tracking', C.leakageWeights.noContractSystem, 'ğŸ“‹');
  if (H.scopeCreep === 'Often')
    addLeakage('scopeCreep', 'Projects often run over scope', C.leakageWeights.oftenOverScope, 'âš ï¸');
  else if (H.scopeCreep === 'Sometimes')
    addLeakage('scopeCreep', 'Projects sometimes run over scope', C.leakageWeights.sometimesOverScope, 'âš ï¸');
  if (H.teamClarity === 'Unclear')
    addLeakage('teamClarity', 'Team unclear on priorities without you', C.leakageWeights.teamClarityUnclear, 'â“');
  else if (H.teamClarity === 'Somewhat Clear')
    addLeakage('teamClarity', 'Team only somewhat clear on priorities', C.leakageWeights.teamClaritySomewhat, 'â“');
  if (H.interruptions === 'Yes')
    addLeakage('interruptions', '10+ daily interruptions from team', C.leakageWeights.highInterruptions, 'ğŸ””');
  if (H.escalations === 'Yes')
    addLeakage('escalations', 'Founder handles all escalations', C.leakageWeights.founderHandlesEscalations, 'ğŸš’');
  if (H.directDelivery === 'No')
    addLeakage('directDelivery', 'All work requires founder review before delivery', C.leakageWeights.teamNoDirectDelivery, 'ğŸ‘€');

  leakagePct = Math.min(leakagePct, C.maxLeakagePct);
  const revenueLeak = S.mrr * leakagePct;
  leakageFactors.sort((a,b) => b.pct - a.pct);

  // COMPONENT 3: Capacity Ceiling
  const freedHrsWeek = (S.reviewHrs + S.meetingHrs * (1 - C.meetingProductivityFactor) + S.fireHrs) * 5;
  const salesFreedHrs = freedHrsWeek * C.freedHoursSalesAllocation;
  const dealsPerMonth = (salesFreedHrs * 4.33) / (C.salesHoursPerDeal[S.biztype] || 6);
  const capacityCeiling = dealsPerMonth * S.acv * C.closeRateAssumption;

  // COMPONENT 4: Firefighting Premium (chaos)
  let chaosCount = 0;
  if (H.kpiReview === 'No') chaosCount++;
  if (H.teamClarity === 'Unclear' || H.teamClarity === 'Somewhat Clear') chaosCount++;
  if (H.interruptions === 'Yes') chaosCount++;
  const chaosKey = Math.min(chaosCount, 3);
  const firefightingPremium = S.mrr * C.chaosMultiplier[chaosKey];

  // TOTAL
  const monthlyOpsTax = timeCost + revenueLeak + capacityCeiling + firefightingPremium;
  const growthMult = C.growthMultiplier[S.growth] || 1.15;
  const annualCost = monthlyOpsTax * 12 * growthMult;
  const growthUnlock = capacityCeiling * 12; // annualized deals possible

  // BOSS SCORE
  let bossScore = 100;
  const bossDeductions = [];

  // Founder Dependency (25 pts)
  let dep = 0;
  if (H.pricingApproval === 'Yes') dep += 8;
  if (H.escalations === 'Yes') dep += 8;
  if (H.directDelivery === 'No') dep += 9;
  bossDeductions.push({ dim: 'Founder Dependency', deduction: dep, max: 25 });

  // Delegation (20 pts)
  let del = 0;
  if (H.teamClarity === 'Unclear') del += 14;
  else if (H.teamClarity === 'Somewhat Clear') del += 7;
  if (H.interruptions === 'Yes') del += 6;
  bossDeductions.push({ dim: 'Delegation & Team Clarity', deduction: del, max: 20 });

  // Cadence (20 pts)
  let cad = 0;
  if (H.kpiReview === 'No') cad += 14;
  if (S.meetingHrs > 2) cad += 6; // still bloated meetings
  bossDeductions.push({ dim: 'Operating Cadence', deduction: cad, max: 20 });

  // Revenue Predictability (20 pts)
  let rev = 0;
  if (H.renewalProcess === 'No') rev += 10;
  if (H.contractSystem === 'No') rev += 6;
  if (H.scopeCreep === 'Often') rev += 4;
  else if (H.scopeCreep === 'Sometimes') rev += 2;
  bossDeductions.push({ dim: 'Revenue Predictability', deduction: rev, max: 20 });

  // Systems (15 pts)
  let sys = 0;
  if (H.contractSystem === 'No') sys += 8;
  if (H.kpiReview === 'No') sys += 4;
  if (H.renewalProcess === 'No') sys += 3;
  bossDeductions.push({ dim: 'Systems & Data Maturity', deduction: sys, max: 15 });

  const totalDeduction = bossDeductions.reduce((s,d) => s + d.deduction, 0);
  bossScore = Math.max(0, Math.min(100, 100 - totalDeduction));

  return {
    hourlyRate, opsHrsPerDay,
    timeCost, revenueLeak, capacityCeiling, firefightingPremium,
    monthlyOpsTax, annualCost, growthUnlock,
    leakageFactors, bossScore, bossDeductions,
    dealsPerMonth, freedHrsWeek
  };
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   BOSS SCORE UI
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function getBossLabel(score) {
  if (score <= 30) return { label: 'Critical', desc: 'The business cannot safely scale. Founder burnout risk within 6 months. This is Phase I territory â€” foundation has to be built before anything else.', color: CONFIG.scoreColors.critical, bg: 'rgba(232,64,64,0.15)', textColor: '#E84040' };
  if (score <= 50) return { label: 'Unstable', desc: 'Operating in firefighting mode. Profitability is fragile. Every growth attempt increases disorder. Phase I work is needed immediately.', color: CONFIG.scoreColors.unstable, bg: 'rgba(232,128,64,0.15)', textColor: '#E88040' };
  if (score <= 70) return { label: 'Developing', desc: 'Systems exist but depend too heavily on the founder. The BOSS Phase I foundation is partially in place. Phase II USP and scaling work can begin in parallel.', color: CONFIG.scoreColors.developing, bg: 'rgba(232,200,64,0.15)', textColor: '#E8C840' };
  if (score <= 85) return { label: 'Functional', desc: 'Delegation is working but the capacity ceiling is near. Ready for Phase II deep work â€” USP isolation, competitive positioning, scaling pipeline.', color: CONFIG.scoreColors.functional, bg: 'rgba(128,200,64,0.15)', textColor: '#80C840' };
  return { label: 'Scale-Ready', desc: 'Operations can support 2â€“3Ã— growth. Phase III sales funnel work and Phase IV growth infrastructure are the right next moves.', color: CONFIG.scoreColors.scaleReady, bg: 'rgba(64,200,128,0.15)', textColor: '#40C880' };
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   NARRATIVE GENERATOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function generateNarrative(r) {
  const S = state;
  const opsHrs = (r.opsHrsPerDay).toFixed(1);
  const pct = Math.round((r.opsHrsPerDay / S.totalHrs) * 100);
  const rate = Math.round(r.hourlyRate);

  return `At $${S.mrr.toLocaleString()} MRR working ${S.totalHrs} hours a day, you're spending ${opsHrs} of those hours â€” ${pct}% of your day â€” as an operations manager. At your founder value of $${rate}/hr, that's $${Math.round(r.timeCost).toLocaleString()}/month of your most expensive time being spent on work that shouldn't need you. Add in revenue leaking through gaps in your systems, and deals you can't pursue because you're too busy to sell â€” and the true cost is $${Math.round(r.monthlyOpsTax).toLocaleString()} every month.`;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   RENDER RESULTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderResults(r) {
  const $ = id => document.getElementById(id);

  $('r-monthly-tax').textContent = '$' + Math.round(r.monthlyOpsTax).toLocaleString();
  $('r-annual-cost').textContent = '$' + Math.round(r.annualCost).toLocaleString();
  $('r-growth-unlock').textContent = '+$' + Math.round(r.capacityCeiling).toLocaleString() + '/mo';

  // BOSS
  const boss = getBossLabel(r.bossScore);
  $('r-boss-number').textContent = r.bossScore;
  $('r-boss-number').style.color = boss.textColor;
  $('r-boss-badge').textContent = boss.label + ' â€” ' + r.bossScore + '/100';
  $('r-boss-badge').style.background = boss.bg;
  $('r-boss-badge').style.color = boss.textColor;
  $('r-boss-desc').textContent = boss.desc;
  setTimeout(() => {
    $('r-boss-bar').style.width = r.bossScore + '%';
    $('r-boss-bar').style.background = boss.color;
  }, 100);

  // Narrative
  $('r-narrative').textContent = generateNarrative(r);

  // Breakdown
  const total = r.monthlyOpsTax;
  const components = [
    { name: 'Time Cost', sub: `${r.opsHrsPerDay.toFixed(1)} hrs/day stuck in ops Ã— $${Math.round(r.hourlyRate)}/hr`, amount: r.timeCost, color: '#E8500A' },
    { name: 'Revenue Leakage', sub: 'From process gaps and missed renewals', amount: r.revenueLeak, color: '#E84040' },
    { name: 'Capacity Ceiling', sub: `~${r.dealsPerMonth.toFixed(1)} deals/mo you can't pursue`, amount: r.capacityCeiling, color: '#E88040' },
    { name: 'Firefighting Premium', sub: 'Reactive culture overhead', amount: r.firefightingPremium, color: '#E8C840' },
  ];
  $('r-breakdown').innerHTML = components.map(c => `
    <div class="breakdown-item">
      <div class="breakdown-bar-wrap">
        <div class="breakdown-name">${c.name}</div>
        <div class="breakdown-sub">${c.sub}</div>
        <div class="breakdown-bar">
          <div class="breakdown-bar-inner" style="width:0%; background:${c.color}" data-target="${Math.round((c.amount/total)*100)}"></div>
        </div>
      </div>
      <div class="breakdown-amount">$${Math.round(c.amount).toLocaleString()}</div>
    </div>
  `).join('');
  setTimeout(() => {
    document.querySelectorAll('.breakdown-bar-inner').forEach(el => {
      el.style.width = el.dataset.target + '%';
    });
  }, 200);

  // Leakage factors (top 5)
  const topFactors = r.leakageFactors.slice(0, 5);
  if (topFactors.length === 0) {
    document.getElementById('r-leakage-block').style.display = 'none';
  } else {
    $('r-leakage-items').innerHTML = topFactors.map(f => `
      <div class="leakage-item">
        <div class="leakage-icon">${f.icon}</div>
        <div class="leakage-text">
          <div class="leakage-name">${f.label}</div>
          <div class="leakage-impact">Costing approx. $${Math.round(f.amount).toLocaleString()}/month</div>
        </div>
        <div class="leakage-pct">${Math.round(f.pct * 100)}%</div>
      </div>
    `).join('');
  }

  // Share text
  const salesMode = new URLSearchParams(window.location.search).get('mode') === 'sales';
  if (salesMode) {
    $('shareText').style.display = 'none';
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   NAVIGATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let currentSection = 'hero';

function showSection(id) {
  document.querySelectorAll('.calc-section, .hero').forEach(el => {
    el.classList.remove('active');
    el.style.display = '';
  });

  // hide hero
  const hero = document.getElementById('heroSection');
  if (id !== 'hero') hero.style.display = 'none';

  if (id === 'hero') {
    hero.style.display = 'block';
  } else {
    const el = document.getElementById('section-' + id);
    if (el) { el.classList.add('active'); el.style.display = 'block'; }
  }

  currentSection = id;
  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress() {
  const map = { hero: 0, a: 20, b: 50, c: 75, results: 100 };
  document.getElementById('progressFill').style.width = (map[currentSection] || 0) + '%';
}

function startCalc() {
  renderHealthQuestions();
  goSection('a');
  // Pre-fill from URL params
  const p = new URLSearchParams(window.location.search);
  if (p.get('mrr')) { state.mrr = parseInt(p.get('mrr')); document.getElementById('sl-mrr').value = state.mrr; updateSlider('mrr', state.mrr); }
  if (p.get('type')) { state.biztype = p.get('type'); document.getElementById('sel-biztype').value = state.biztype; }
}

function goSection(id) {
  if (id === 'b') {
    state.growth = document.getElementById('sel-growth').value;
    // Init chart on first visit to B
    setTimeout(() => {
      if (!pieChart) initPieChart();
      else updatePieChart();
      updateHourlyRate();
    }, 100);
  }
  showSection(id);
}

function calculateAndShow() {
  // Validate all questions answered
  const unanswered = QUESTIONS.filter(q => !state.health[q.id]);
  if (unanswered.length > 0) {
    // Scroll to first unanswered
    const firstEl = document.getElementById('opts-' + unanswered[0].id);
    if (firstEl) firstEl.closest('.yn-field').scrollIntoView({ behavior: 'smooth', block: 'center' });
    firstEl.style.outline = '1px solid var(--orange)';
    setTimeout(() => firstEl.style.outline = '', 2000);
    return;
  }

  const result = calculate();
  renderResults(result);
  showSection('results');
}

function restartCalc() {
  state.health = {};
  showSection('hero');
  document.getElementById('heroSection').style.display = 'block';
  currentSection = 'hero';
  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PDF EXPORT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function downloadPDF() {
  const r = calculate();
  const boss = getBossLabel(r.bossScore);
  const date = new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });

  const win = window.open('', '_blank');
  win.document.write(`<!DOCTYPE html><html><head><meta charset="UTF-8">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  body { font-family: 'DM Sans', sans-serif; background: #0F0F0F; color: #F8F5F0; margin: 0; padding: 40px; max-width: 680px; margin: 0 auto; }
  .brand { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 22px; color: #E8500A; margin-bottom: 4px; }
  .date { font-size: 12px; color: #6B6B6B; margin-bottom: 32px; }
  .tax-label { font-size: 12px; letter-spacing: 0.12em; text-transform: uppercase; color: #6B6B6B; }
  .tax-amount { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 64px; color: #E8500A; line-height: 1; margin: 4px 0 24px; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px; }
  .card { background: #1A1A1A; border: 1px solid #2A2A2A; border-radius: 4px; padding: 16px; }
  .card-label { font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; color: #6B6B6B; margin-bottom: 4px; }
  .card-val { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 20px; }
  .boss-block { background: #1A1A1A; border: 1px solid #2A2A2A; border-radius: 4px; padding: 20px; margin-bottom: 24px; }
  .boss-num { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 48px; color: ${boss.textColor}; }
  .boss-label { display: inline-block; background: ${boss.bg}; color: ${boss.textColor}; font-size: 12px; font-weight: 600; padding: 3px 10px; border-radius: 100px; margin: 4px 0 8px; }
  .boss-desc { font-size: 13px; color: #6B6B6B; }
  .section-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 16px; margin: 24px 0 12px; }
  .row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #2A2A2A; font-size: 13px; }
  .row:last-child { border-bottom: none; }
  .row-label { color: #F8F5F0; }
  .row-val { font-family: 'Syne', sans-serif; font-weight: 700; color: #E8500A; }
  .narrative { border-left: 3px solid #E8500A; padding-left: 16px; margin: 20px 0; font-size: 13px; color: #9A9A9A; line-height: 1.6; font-style: italic; }
  .cta { background: rgba(232,80,10,0.1); border: 1px solid #E8500A; border-radius: 4px; padding: 20px; text-align: center; margin-top: 28px; }
  .cta-headline { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 18px; margin-bottom: 6px; }
  .cta-link { color: #E8500A; font-weight: 500; font-size: 14px; }
  .footer { font-size: 11px; color: #444; text-align: center; margin-top: 32px; border-top: 1px solid #2A2A2A; padding-top: 16px; }
</style></head><body>
<div class="brand">VBOG</div>
<div class="date">Ops Tax Report Â· ${date}</div>
<div class="tax-label">Monthly Ops Tax</div>
<div class="tax-amount">$${Math.round(r.monthlyOpsTax).toLocaleString()}</div>
<div class="grid">
  <div class="card"><div class="card-label">12-Month Cost</div><div class="card-val">$${Math.round(r.annualCost).toLocaleString()}</div></div>
  <div class="card"><div class="card-label">Growth Unlock</div><div class="card-val" style="color:#40C880">+$${Math.round(r.capacityCeiling).toLocaleString()}/mo</div></div>
</div>
<div class="boss-block">
  <div class="boss-num">${r.bossScore}<span style="font-size:20px;color:#6B6B6B">/100</span></div>
  <div class="boss-label">${boss.label}</div>
  <div class="boss-desc">${boss.desc}</div>
</div>
<div class="narrative">${generateNarrative(r)}</div>
<div class="section-title">Breakdown</div>
${[
  ['Time Cost', r.timeCost],
  ['Revenue Leakage', r.revenueLeak],
  ['Capacity Ceiling', r.capacityCeiling],
  ['Firefighting Premium', r.firefightingPremium],
].map(([l,v]) => `<div class="row"><span class="row-label">${l}</span><span class="row-val">$${Math.round(v).toLocaleString()}/mo</span></div>`).join('')}
${r.leakageFactors.length > 0 ? `
<div class="section-title">Top Leakage Factors</div>
${r.leakageFactors.slice(0,4).map(f => `<div class="row"><span class="row-label">${f.icon} ${f.label}</span><span class="row-val" style="color:#E84040">${Math.round(f.pct*100)}%</span></div>`).join('')}
` : ''}
<div class="cta">
  <div class="cta-headline">Stop paying this tax.</div>
  <div class="cta-link">v-bog.com Â· Book a free discovery call</div>
</div>
<div class="footer">Generated by VBOG Ops Tax Calculator Â· v-bog.com Â· Confidential</div>
</body></html>`);
  win.document.close();
  setTimeout(() => win.print(), 800);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SHARE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function shareResult() {
  const r = calculate();
  const boss = getBossLabel(r.bossScore);
  const text = `I just calculated my Ops Tax â€” I'm losing $${Math.round(r.monthlyOpsTax).toLocaleString()}/month running my business instead of growing it. BOSS Score: ${r.bossScore}/100 (${boss.label}). Calculate yours â†’ v-bog.com`;
  if (navigator.clipboard) {
    navigator.clipboard.writeText(text).then(() => alert('Copied to clipboard â€” paste it on LinkedIn or Twitter!'));
  } else {
    prompt('Copy this to share:', text);
  }
}

function emailResults() {
  const email = document.getElementById('emailInput').value;
  if (!email || !email.includes('@')) { alert('Enter a valid email address.'); return; }
  // In production: hook this to your email service (Mailchimp, ConvertKit, etc.)
  // For now, show confirmation
  document.getElementById('emailInput').value = '';
  const row = document.querySelector('.email-row');
  row.innerHTML = '<p style="font-size:13px;color:var(--green);padding:10px 0;">âœ“ Got it â€” check your inbox shortly.</p>';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   INIT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.addEventListener('DOMContentLoaded', () => {
  // Sales mode: hide share
  const salesMode = new URLSearchParams(window.location.search).get('mode') === 'sales';
  if (salesMode) {
    const el = document.getElementById('shareText');
    if (el) el.style.display = 'none';
  }
});
</script>
</body>
</html>
